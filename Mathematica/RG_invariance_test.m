(* ::Package:: *)

(* ::Input:: *)
(*Needs["NumericalCalculus`"];*)
(*(*load function definitions*)*)
(*Get[FileNameJoin[{"/scratch/work/acaroglu/tsil-mma-master","src","LibraryLink.m"}]];*)
(**)
(*(*initialize the LibrayLink*)*)
(*TSILInitialize[FileNameJoin[{"/scratch/work/acaroglu/tsil-mma-master/build/src","LibraryLink.so"}]];*)


(* ::Input:: *)
(*(* define polemass and derivative*)*)
(*s=t+k (g3^2 delta1QCD+delta1Yukawa)+k^2 (g3^4 delta2QCD+g3^2 delta2mixed+delta2Yukawa);*)


(* ::Input:: *)
(*(*Define B and A loop integrals in order to evaluate scale dependance analytically*)*)
(*ln[x_]=Log[x]-2q;  *)
(*del[x_,y_,z_]:=x^2+y^2+z^2-2x*y-2x*z-2y*z;*)
(*tau[x_,y_,z_]:=(x+y-z+Sqrt[del[x,y,z]])/(2*x);*)
(*r[x_,y_,z_]:=(x+y-z-Sqrt[del[x,y,z]])/(2*x);*)
(*A[x_]:= x(ln[x]-1);*)
(*B[x_,y_,s_]:= 2-r[s,x,y]ln[x]-tau[s,y,x]ln[y]+(Sqrt[del[s,x,y]]/s)*Log[tau[x,y,s]]; *)


(* ::Input:: *)
(*dBhtdh=1/del[t,h,t] ((h-2t)(Bht-2)+Ah+h-2At-2t)//Simplify;*)
(*dBhtdt=h/t 1/del[t,h,t] ((2t-h)(Bht-1)-Ah+2At)-1/t//Simplify;*)


(* ::Input:: *)
(*(*Order Subscript[\[Alpha], s],Subscript[\[Alpha], t]*)*)
(*(*faktor = 1;*)*)
(*delta1QCD=t(32/3-8(At/t+1));*)
(*delta1Yukawa=(t (Ah-2 At+Bht h-B00 t-4 Bht t))/v^2;*)


(* ::Input:: *)
(*(*Order Subscript[\[Alpha], s]^2,Subscript[\[Alpha], t]^2,Subscript[\[Alpha], s]Subscript[\[Alpha], t]*)*)
(**)
(*delta2QCD = t(2309/9+(16\[Pi]^2)/9+(32\[Pi]^2 Log[2])/9-(16Zeta[3])/3-204(At/t+1)+60(At/t+1)^2);*)
(*delta2mixed=1/(9 h t v^2) (-24 At^2 h (h-t)+24 At t (Ah (3 h+5 t)+h ((5+2 Bht) h+2 (-12+Bht) t))+2 t (-60 Ah t^2-2 h^2 (3 Ihtt+t (-6-51 Bht-8 \[Pi]^2+72 M0ttht t+12 Tbar0ht-24 Th0t))-6 h^3 (1+Bht-4 M0ttht t+Th0t)+h t (-54 Ah+84 Ihtt+t (333-288 Bht-61 \[Pi]^2+24 M00t00 t+192 M0ttht t+96 Tbar0ht-60 Th0t-96 Uthtt))));*)
(*delta2Yukawa=1/(48 v^4) (-72 Bht h^3-12 h^2 I0h0+12 h^2 Ih00+12 h^3 \[Pi]^2-336 h^2 t+528 Bht h^2 t-60 Bht^2 h^2 t+288 h I0h0 t+120 h I0h0 t-144 h Ih00 t-288 h Ihhh t+96 h Ihtt t-96 h Ih00 t-52 h^2 \[Pi]^2 t+96 h^2 q t+96 B0h h^2 q t-336 h S0h0 t+258 h t^2-768 Bht h t^2-72 B00 Bht h t^2+336 Bht^2 h t^2+96 Bt0 h t^2-96 Bht Bt0 h t^2+72 I0h0 t^2+336 I0t0 t^2-960 Ihtt t^2+432 h^2 Mhhtth t^2+48 h^2 Mhttht t^2-96 h^2 Mh0tt0 t^2-48 h^2 Mtt00h t^2+64 h \[Pi]^2 t^2-288 h q t^2-96 B00 h q t^2+96 B0h h q t^2+288 Bt0 h q t^2+72 S0h0 t^2+1131 t^3-444 B00 t^3+96 B00^2 t^3-2112 Bht t^3+48 B00 Bht t^3-384 Bht^2 t^3+(1728 Ihtt t^3)/h-192 h M0t0h0 t^3-1152 h Mhhtth t^3+384 h Mhttht t^3-96 \[Pi]^2 t^3-144 q t^3+144 Bt0 q t^3+(1152 t^4)/h+(2304 Bht t^4)/h-768 Mhttht t^4+(36 Ah^2 (h^2-6 h t-5 t^2))/h+(96 At^2 (h^2-18 h t+42 t^2))/h-(24 At (6 (-1+Bht) h^3-4 h^2 (-7+8 Bht-Bt0+3 q) t+h (-27-10 B00+64 Bht+18 q) t^2+48 (3-2 Bht) t^3))/h-1/h 24 Ah (3 h^3+h^2 (-35+2 B00-4 Bht+Bt0-4 q) t+(-25-4 B00+4 Bht) h t^2+(9+4 B00+32 Bht) t^3+At (7 h^2-8 h t+39 t^2))+96 t^3 Tbar000+48 h^2 t Tbar00h+48 h t^2 Tbar00h+96 h t^2 Tbar0t0+96 t^3 Tbar0t0-12 t^3 Tbar000+48 h t^2 Tbar0t0-24 t^3 Tbar0t0-120 h^2 t Th00+168 h t^2 Th00-96 t^3 Th00-72 h^3 Th0t+384 h^2 t Th0t-384 h t^2 Th0t+408 h t^2 Thht-408 t^3 Thht+48 h^2 t Tht0+24 h t^2 Tht0+24 h^2 t Tth0+48 h t^2 Tth0-144 t^3 Tth0+72 h t^2 U000h+576 t^3 U000t-12 t^3 U0000-48 h^2 t U00h0+144 h t^2 U00h0-120 h t^2 Uht00+240 t^3 Uht00-72 h^2 t Uhtht+384 t^3 Uhtht-96 h t^2 Uhtt0-96 h^2 t Uth00+288 h t^2 Uth00-288 h^2 t Uthhh+432 h t^2 Uthhh-864 h t^2 Uthtt+2688 t^3 Uthtt-48 h^2 t Uth00+240 h t^2 Uth00-24 h^2 t Ut0h0-96 h t^2 U0tht+96 h t^2 U0tt0+1/(h-t) 4 (3 h^4 (7-12 \[Pi]^2)+3 h^3 (22+19 \[Pi]^2) t+h^2 (33-23 \[Pi]^2) t^2+2 h (13 \[Pi]^2-72 (1+q)^2) t^3-24 (\[Pi]^2-6 (1+q)^2) t^4+3 h (h-t) t (h+2 t) Log[h]^2-6 t^2 (-2 h+3 t) (-h+4 t) Log[t]+36 (h-t) t^3 Log[t]^2+3 h Log[-h+t] (2 t (-5 h^2+h t+t^2)-(-h+t) (-4 h^2+h t+2 t^2) Log[-h+t])+6 h Log[h] (h t (h+5 t)+(-h+t) (2 t^2 Log[t]+h (-2 h+t) Log[-h+t]))+18 h^4 Log[-1+t/h]+6 h t (-h+t) (-(h+2 t) PolyLog[2,t/h]-(h-2 t) PolyLog[2,t/(-h+t)])));*)
(**)


(* ::Input:: *)
(*(*SM beta functions, Subscript[\[Lambda], Alex]=2Subscript[\[Lambda], Martin], Subscript[\[Lambda], Martin]=h/(2v^2) so everywhere \[Lambda]\[Rule]h/v^2; also Subscript[\[Beta], Martin](Subscript[\[Lambda], Martin])=\!\(\( *)
(*\*FractionBox[\(1\), \(2\)]*)
(*\*SubscriptBox[\(\[Beta]\), \(Alex\)]\(( *)
(*\*SubscriptBox[\(\[Lambda]\), \(Alex\)])\)\)*)
(*\*SubscriptBox[\(|\), \( *)
(*\*SubscriptBox[\(\[Lambda]\), \(Alex\)] = 2*)
(*\*SubscriptBox[\(\[Lambda]\), \(Martin\)]\)]\)*)*)
(*CASE={g1->0,g2->0,g\[Tau]->0,gb->0,gt->Sqrt[2t]/v,\[Lambda]->h/v^2};*)
(*betag3=(-k 7*g3^3 +k^2 g3^3*((11*g1^2)/10+(9*g2^2)/2-2*(13*g3^2+gb^2+gt^2))+ k^3 (g3^3*(-523*g1^4+g1^2*(-9*g2^2+616*g3^2-303*gt^2)+15*(109*g2^4+3*g2^2*(56*g3^2-31*gt^2)+20*(13*g3^4-16*g3^2*gt^2+6*gt^4))))/120+k^4 (-(1/36) g3^3 (4 g3^4 gt^2 (6709-2448 Zeta[3])+36 g3^2 gt^4 (-427+96 Zeta[3])+2 g3^6 (-63559+89896 Zeta[3])+27 (20 gt^4 \[Lambda]-12 gt^2 \[Lambda]^2+gt^6 (141+8 Zeta[3])))))/.CASE; *)
(*betayt=(k gt*((-17*g1^2)/20-(9*g2^2)/4-8*g3^2+(3*gb^2)/2+(9*gt^2)/2+g\[Tau]^2)-k^2(gt*(-2374*g1^4+5*g1^2*(108*g2^2-304*g3^2-3*(7*gb^2+393*gt^2+150*g\[Tau]^2))+75*(92*g2^4-3*g2^2*(48*g3^2+33*gb^2+75*gt^2+10*g\[Tau]^2)+4*(432*g3^4+gb^4+48*gt^4-16*g3^2*(gb^2+9*gt^2)+9*gt^2*g\[Tau]^2+9*g\[Tau]^4+gb^2*(11*gt^2-5*g\[Tau]^2)+24*gt^2*\[Lambda]-6*\[Lambda]^2))))/1200+k^3(gt*(321980*g1^6+3396580*g2^6-5*g1^4*(17768*g2^2+89276*g3^2+97688*gt^2+5445*\[Lambda])-5*g2^4*(84288*g3^2-67960*gt^2+21375*\[Lambda])-10*g1^2*(9486*g2^4+30192*g3^4-36148*g3^2*gt^2+60925*gt^4+g2^2*(32100*g3^2-69658*gt^2-2925*\[Lambda])+12700*gt^2*\[Lambda]-4500*\[Lambda]^2)+2*(-6193500*g3^6+3637640*g3^4*gt^2+586028*gt^6+990000*gt^4*\[Lambda]+9375*gt^2*\[Lambda]^2-45000*\[Lambda]^3-10000*g3^2*(157*gt^4-8*gt^2*\[Lambda]))+10*g2^2*(147308*g3^4+96740*g3^2*gt^2-1125*(177*gt^4+60*gt^2*\[Lambda]-20*\[Lambda]^2))))/20000+k^4 2*1154.09 g3^8 gt)/.CASE;*)
(*betalambda=1/2 (k (27*g1^4+90*g1^2*(g2^2-2*\[Lambda])+25*(9*g2^4-36*g2^2*\[Lambda]-16*(3*gb^4+3*gt^4+g\[Tau]^4-3*gb^2*\[Lambda]-3*gt^2*\[Lambda]-g\[Tau]^2*\[Lambda]-3*\[Lambda]^2)))/100+k^2(-3411*g1^6-15*g1^4*(559*g2^2-60*gb^2+228*gt^2+300*g\[Tau]^2-629*\[Lambda])-25*g1^2*(289*g2^4-6*g2^2*(36*gb^2+84*gt^2+44*g\[Tau]^2+39*\[Lambda])-4*(16*gb^4-32*gt^4-48*g\[Tau]^4+25*gb^2*\[Lambda]+85*gt^2*\[Lambda]+75*g\[Tau]^2*\[Lambda]+108*\[Lambda]^2))+125*(305*g2^6+12*g2^2*\[Lambda]*(15*gb^2+15*gt^2+5*g\[Tau]^2+36*\[Lambda])-g2^4*(36*gb^2+36*gt^2+12*g\[Tau]^2+73*\[Lambda])-8*(-60*gb^6-60*gt^6-20*g\[Tau]^6+3*gt^4*\[Lambda]+g\[Tau]^4*\[Lambda]+72*gt^2*\[Lambda]^2+24*g\[Tau]^2*\[Lambda]^2+78*\[Lambda]^3+3*gb^4*(4*gt^2+\[Lambda])+16*g3^2*(4*gb^4+4*gt^4-5*gb^2*\[Lambda]-5*gt^2*\[Lambda])+6*gb^2*(2*gt^4+7*gt^2*\[Lambda]+12*\[Lambda]^2))))/1000+k^3(-60320*g1^8-4563640*g2^8-40*g1^6*(1543*g2^2-663*g3^2-11117*gt^2-14084*\[Lambda])+20*g2^6*(15072*g3^2+125000*gt^2+865483*\[Lambda])+80*g2^4*(7942*gt^4+6*g3^2*(1372*gt^2-2381*\[Lambda])-79916*gt^2*\[Lambda]-98785*\[Lambda]^2)+2*g1^4*(130000*g2^4+318960*gt^4+10*g3^2*(2032*gt^2-8381*\[Lambda])-748599*gt^2*\[Lambda]-927660*\[Lambda]^2+10*g2^2*(2210*g3^2+21254*gt^2+61753*\[Lambda]))-10*g1^2*(151556*g2^6-135720*gt^6+42030*gt^4*\[Lambda]+63869*gt^2*\[Lambda]^2+38745*\[Lambda]^3-4*g2^4*(1507*g3^2+13041*gt^2+39819*\[Lambda])-4*g3^2*(17570*gt^4+8727*gt^2*\[Lambda])+g2^2*(-45544*g3^2*gt^2+281424*gt^4-11230*gt^2*\[Lambda]+316640*\[Lambda]^2))-5*(1945192*gt^8+893528*gt^6*\[Lambda]-3536520*gt^4*\[Lambda]^2-873000*gt^2*\[Lambda]^3-3005675*\[Lambda]^4+8*g3^4*(50201*gt^4-178484*gt^2*\[Lambda])-4*g3^2*(500988*gt^6-662866*gt^4*\[Lambda]+80385*gt^2*\[Lambda]^2))+2*g2^2*(g3^2*(266980*gt^4+151443*gt^2*\[Lambda])+5*(296552*gt^6-10940*gt^4*\[Lambda]-359539*gt^2*\[Lambda]^2-193726*\[Lambda]^3)))/10000+k^4 2*8308.17*g3^6*gt^4)/.CASE; *)
(*betav=(k (v*(3*g1^2*(3+Xi)+5*(-4*(3*gb^2+3*gt^2+g\[Tau]^2)+3*g2^2*(3+Xi))))/20+k^2(v*(3*g1^4*(-431+12*Xi+12*Xi^2)+10*g1^2*(9*g2^2*(-3+4*Xi+4*Xi^2)-2*(3*g\[Tau]^2*(25+4*Xi)+gb^2*(25+36*Xi)+gt^2*(85+36*Xi)))+25*(-12*g2^2*(3*gb^2+3*gt^2+g\[Tau]^2)*(5+4*Xi)+g2^4*(271+108*Xi)-8*(80*g3^2*(gb^2+gt^2)-3*(9*gb^4-2*gb^2*gt^2+9*gt^4+3*g\[Tau]^4-2*\[Lambda]^2)))))/800)/.CASE;*)
(*betah=2v^2 betalambda + (2h)/v betav;*)
(*betat=Sqrt[2t]v betayt+(2t)/v betav;*)


(* ::Input:: *)
(*ds=Dt[s]/.{Dt[k]->0,Dt[g3]->betag3,Dt[h]->betah,Dt[t]->betat,Dt[v]->betav,Dt[q]->1};*)


(* ::Input:: *)
(*CASE2={Dt[Ah]->-2h+betah (Ah/h+1),*)
(*Dt[At]->-2t+betat (At/t+1),*)
(*Dt[Bht]->2+dBhtdh betah+dBhtdt betat,*)
(*Dt[B00]->2-betat/t,*)
(*Dt[Bt0]->2,*)
(*Dt[B0h]->2,*)
(*Dt[I0h0]-> 2(Ah-h),*)
(*Dt[Ih00]-> 2(Ah-h),*)
(*Dt[I0t0]-> 2(At-t),*)
(**)
(*Dt[Ihtt]-> 2(Ah-h)+4(At-t),*)
(*Dt[Ihhh]->6(Ah-h),*)
(*Dt[Thht]->-2 Ah/h,*)
(*Dt[Th00]->-2 Ah/h,*)
(*Dt[Th0t]->-2 Ah/h,*)
(*Dt[Tht0]->-2 Ah/h,*)
(*Dt[Tth0]->-2 At/t,*)
(*Dt[S0h0] -> t+2(Ah-h),*)
(*Dt[Tbar0ht]-> 2-2Bht,*)
(*Dt[Tbar000]->2-2B00,*)
(*Dt[Tbar0t0]->2-2Bt0,*)
(*Dt[Tbar00h]->2-2B0h,*)
(*Dt[Uthtt] -> 2+2Bht,*)
(*Dt[Uhtht] ->2+2Bht,*)
(*Dt[Uthhh] ->2+2Bht,*)
(*Dt[U0000] ->2+2B00,*)
(*Dt[U000h] ->2+2B00,*)
(*Dt[U00h0] ->2+2B00,*)
(*Dt[U000t] ->2+2B00,*)
(*Dt[U0tht] ->2+2Bt0,*)
(*Dt[U0tt0] ->2+2Bt0,*)
(*Dt[Uht00] ->2+2Bht,*)
(*Dt[Uhtt0] ->2+2Bht,*)
(*Dt[Ut0h0] ->2+2Bt0,*)
(*Dt[Uth00] ->2+2Bht,*)
(*Dt[M0ttht]-> 0,*)
(*Dt[Mhhtth]-> 0,*)
(*Dt[Mhttht]-> 0,*)
(*Dt[M00t00]-> 0,*)
(*Dt[M0t0h0]->0,*)
(*Dt[Mh0tt0]->0,*)
(*Dt[Mtt00h]->0};*)


(* ::Input:: *)
(*Simplify[Series[ds,{k,0,1}]/.CASE2//Normal]*)


(* ::Input:: *)
(*(Series[ ds,{k,0,2}]/.CASE2//Normal)/.B00->(1-At/t)//Simplify*)
